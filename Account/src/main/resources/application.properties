#
quarkus.arc.remove-unused-beans=true
quarkus.index-dependency.runtime.group-id=com.hts.account
quarkus.index-dependency.runtime.artifact-id=account

# Database Configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=hts
quarkus.datasource.password=hts
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/hts_account

# JOOQ Configuration
quarkus.jooq.dialect=POSTGRES

#  Thread Pool
quarkus.thread-pool.core-threads=128
quarkus.thread-pool.max-threads=256
quarkus.thread-pool.queue-size=10000
quarkus.thread-pool.growth-resistance=0

# AccountShardInvoker
# Connection Pool
quarkus.datasource.jdbc.initial-size=64
quarkus.datasource.jdbc.max-size=64
quarkus.datasource.jdbc.min-size=64
quarkus.datasource.jdbc.acquisition-timeout=500
quarkus.datasource.jdbc.leak-detection-interval=30s
quarkus.datasource.jdbc.idle-timeout=3m
quarkus.datasource.jdbc.max-lifetime=15m
quarkus.datasource.jdbc.validation-query-sql=SELECT 1
quarkus.datasource.jdbc.background-validation-interval=30s

# Flyway Migration
quarkus.flyway.migrate-at-start=true

# gRPC Server
quarkus.grpc.server.use-separate-server=true
quarkus.grpc.server.port=8081
quarkus.grpc.server.plain-text=true

# Kafka Event Publisher
mp.messaging.outgoing.account-events.connector=smallrye-kafka
mp.messaging.outgoing.account-events.topic=trading.account.events
mp.messaging.outgoing.account-events.value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer
mp.messaging.outgoing.account-events.bootstrap.servers=localhost:9092
#
mp.messaging.outgoing.account-events.acks=1
mp.messaging.outgoing.account-events.linger.ms=10
mp.messaging.outgoing.account-events.batch.size=32768
mp.messaging.outgoing.account-events.compression.type=lz4
mp.messaging.outgoing.account-events.max-inflight-messages-per-partition=10

# Kafka Event Consumers (Phase 1)
# 1. (Matching Engine Account)
mp.messaging.incoming.trading-fills.connector=smallrye-kafka
mp.messaging.incoming.trading-fills.topic=trading.fills
mp.messaging.incoming.trading-fills.value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer
mp.messaging.incoming.trading-fills.group.id=account-service
mp.messaging.incoming.trading-fills.auto.offset.reset=earliest
mp.messaging.incoming.trading-fills.bootstrap.servers=localhost:9092

# 2. (Payment Account)
mp.messaging.incoming.payment-deposits.connector=smallrye-kafka
mp.messaging.incoming.payment-deposits.topic=payment.deposits
mp.messaging.incoming.payment-deposits.value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer
mp.messaging.incoming.payment-deposits.group.id=account-service
mp.messaging.incoming.payment-deposits.auto.offset.reset=earliest
mp.messaging.incoming.payment-deposits.bootstrap.servers=localhost:9092

# 3. (Payment Account)
mp.messaging.incoming.payment-withdrawals.connector=smallrye-kafka
mp.messaging.incoming.payment-withdrawals.topic=payment.withdrawals
mp.messaging.incoming.payment-withdrawals.value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer
mp.messaging.incoming.payment-withdrawals.group.id=account-service
mp.messaging.incoming.payment-withdrawals.auto.offset.reset=earliest
mp.messaging.incoming.payment-withdrawals.bootstrap.servers=localhost:9092

# Circuit Breaker (Phase 3)
# quarkus.smallrye-fault-tolerance.enabled=true

quarkus.log.level=WARN
quarkus.log.category."com.hts.account".level=INFO
quarkus.log.category."com.hts.account.grpc.AccountShardInvoker".level=INFO
%dev.quarkus.log.category."io.vertx.core.impl.BlockedThreadChecker".level=ERROR

quarkus.log.console.async.queue-length=10000
quarkus.log.console.async.overflow=DISCARD

# Redis Configuration
quarkus.redis.hosts=redis://localhost:6379

# Prometheus Metrics
quarkus.http.port=9081
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/metrics
quarkus.micrometer.binder.http-server.enabled=true


quarkus.flyway.repair-at-start=true
